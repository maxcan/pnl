<script type='text/ng-template' id='tradeSelector'>
  <h3>{{filterObj.groupName}}</h3>
  <form class="form form-horizontal">
    <div class="control-group">
      <label class="control-label">Start Date</label>
      <div class="controls">
        <input ng-change='checkAllFilters()' ng-model="filterObj.startDate" ui-date>
      </div>
    </div>
    <div class="control-group">
      <label class="control-label">End Date</label>
      <div class="controls">
        <input ng-change='checkAllFilters()' ng-model="filterObj.endDate" ui-date>
      </div>
    </div>
    <div class="control-group">
      <label class="control-label">Side</label>
      <div class="controls">
        <select ng-change='checkAllFilters()' ng-model="filterObj.side">
          <option value="both">Long and Short</option>
          <option value="long">Long Only</option>
          <option value="short">Short Only</option>
        </select>
      </div>
    </div>
    <div class="control-group">
      <label class="control-label">Duration</label>
      <div class="controls">
        <select ng-change='checkAllFilters()' ng-model="filterObj.duration">
          <option value="intraday" selected>Intraday</option>
          <option value="interday">Multiple Days</option>
        </select>
      </div>
    </div>
  </form>
</script>
<script type='text/ng-template' id='tradeSummary'>
  <dl class="dl-horizontal">
    <dt>Total Trades:
    <dd>{{data.trades.length}}
    <dt>Net Cash:
    <dd>{{data.netCash | currency}}
    <dt>Win Percent
    <dd>{{data.wins / data.trades.length | percent}}
    <dt>Wins
    <dd>{{data.wins}}
    <dt>Losses
    <dd>{{data.losses}}
  </dl>
  <table class="table table-condensed table-striped table-bordered">
    <thead>
      <tr>
        <th></th>
        <th>Symbol</th>
        <th>Net Cash</th>
        <th>Open Date</th>
        <th>Close Date</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="trade in data.trades">
        <td><button ng-click="showTradeDetails(trade)" class="btn btn-small">Details</button></td>
        <td>{{trade.symbol}}</td>
        <td>{{trade.netCash  | currency}}</td>
        <td>{{trade.openDate | date:'shortDate'}}</td>
        <td>{{trade.closeDAte | date:'shortDate'}}</td>
      </tr>
    </tbody>
  </table>
</script>

<div ng-controller="CompareCtrl">
  <div id="tradeDetailsModal" class="modal hide fade" >
    <div class="modal-header">
      <h3>{{detailTrade.symbol}} </h3>
    </div>
    <div class="modal-body">
      <h4>
        <div ng-switch on="detailTrade.isOpen">
          <div ng-switch-when="true">
            <dl class="dl-horizontal">
              <dt>Open Quantity:</dt>
              <dd>{{detailTrade.netQty}} shares</dd>
              <dt>Security</dt>
              <dd>{{detailTrade.securityDesc}}</dd>
              <dt>Open Date:</dt>
              <dd>{{detailTrade.openDate | date:'short'}}</dd>
              <dt></dt>
              <dd></dd>
            </dl>
          </div>
          <div ng-switch-default>
            <dl class="dl-horizontal">
              <dt>Net Cash:</dt>
              <dd>{{detailTrade.netCash | currency}}</dd>
              <dt>Open Date:</dt>
              <dd>{{detailTrade.openDate | date:'short'}}</dd>
              <dt>Close Date:</dt>
              <dd>{{detailTrade.closeDate | date:'short'}}</dd>
              <dt>Security</dt>
              <dd>{{detailTrade.securityDesc}}</dd>
              <dt></dt>
              <dd></dd>
            </dl>

          </div>
        </div>
      </h4>
      Fills:
      <table class="table table-striped table-condensed fill-minitable">
        <thead><tr><td>Qty</td><td></td><td>Price</td><td>Date</td><td>Time</td></tr></thead>
        <tbody>
          <tr ng-repeat="fill in detailTrade.fills | orderBy:date">
            <td> {{fill.qty}}</td>
            <td> @ </td>
            <td>{{fill.avgPx}}</td> 
            <td>{{fill.date | date:'yyyy-MM-dd'}}</td>
            <td>{{fill.date | date:'mediumTime'}}</td>
          </tr>
        </tbody>
      </table>
      Notes:
      <textarea id="detail_trade_notes" ng-model="detailTrade.notes"></textarea>
    </div>
    <div class="modal-footer">
      <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
  </div>
  <div class="container-fluid">
    <div class="row-fluid">
      <div class="span5">
        <ng-include ng-repeat="filterObj in [left.filter]" src="'tradeSelector'"></ng-include>
      </div>
      <div class="span2 well">
        <h3>{{trades | count }} Closed Trades </h3>
      </div>
      <div class="span5">
        <ng-include ng-repeat="filterObj in [right.filter]" src="'tradeSelector'"></ng-include>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span5">
        <ng-include ng-repeat="data in [left.data]" src="'tradeSummary'"></ng-include>
      </div>
      <div class="span2">
      </div>
      <div class="span5">
        <ng-include ng-repeat="data in [right.data]" src="'tradeSummary'"></ng-include>
      </div>
    </div>
  </div>
</div>
