<div ng-controller="HomeCtrl">
  <!-- <h1> name = {{user.name}} </h1> --> 
  <h2> email = {{user.email}} </h2>
  <h2> 
    dropbox = 
    <a href="mailto://{{user.reportDropboxAddr[0]}}">{{user.reportDropboxAddr[0]}}</a>
  </h2>
  <div app-upload>
    Files go here
  </div>
  <p>
    Filter Trades: 
    <input ng-model="tradeFilter">
  </p>
  <h3>Closed Trades </h3>
  <h4> 
    Total PnL:  <span ng-bind="filteredClosedTrades  | pluck:'netCash' | sum | currency"/>
  </h4>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Symbol</th>
        <th>Net Cash</th>
        <th>Bot</th>
        <th>Sold</th>
        <th>Duration</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="trade in filteredClosedTrades = (trades | filter: tradeFilter | filter: {isOpen:false} )">
        <td>{{trade.symbol}}</td>
        <td>{{trade.netCash | currency}}</td>
        <td>{{trade.totalBuy}}</td>
        <td>{{trade.totalSell}}</td>
        <td>{{trade.duration | timespan}}</td>
        <td>
          <ul>
            <li ng-repeat="fill in trade.fills">
              Qty: {{fill.qty}} Price: {{fill.avgPx}} Date: {{fill.date}}
            </li>
          </ul>
        </td>
      </tr>
    </tbody>
  </table>
  <h3> Open Trades</h3>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Symbol</th>
        <th>Bot</th>
        <th>Sold</th>
        <th>Open Date
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="trade in trades | filter: tradeFilter | filter: {isOpen:true}">
        <td>{{trade.symbol}}</td>
        <td>{{trade.totalBuy}}</td>
        <td>{{trade.totalSell}}</td>
        <td>{{trade.openDate | date:'medium'}}</td>
        <td>
          <ul>
            <li ng-repeat="fill in trade.fills">
              Qty: {{fill.qty}} Price: {{fill.avgPx}} Date: {{fill.date}}
            </li>
          </ul>
        </td>
      </tr>
    </tbody>
  </table>
</div>
